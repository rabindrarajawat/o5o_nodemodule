{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.reducer = void 0;\n\nconst react_1 = require(\"react\");\n\nconst status_1 = require(\"../utils/status\");\n\nconst logger_1 = __importDefault(require(\"../logger\"));\n\nconst types_1 = require(\"../types\");\n\nconst config_1 = require(\"../config\");\n\nconst utils_1 = require(\"../useReducer/utils\");\n\nconst gatewayStatusToCivicPassAction = {\n  [types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP]: types_1.CivicPassMessageAction.PROOF_OF_WALLET_OWNERSHIP,\n  [types_1.GatewayStatus.IN_REVIEW]: types_1.CivicPassMessageAction.TOKEN_IN_REVIEW,\n  [types_1.GatewayStatus.ERROR]: types_1.CivicPassMessageAction.ERROR,\n  [types_1.GatewayStatus.ACTIVE]: types_1.CivicPassMessageAction.TOKEN_ACTIVE,\n  [types_1.GatewayStatus.REVOKED]: types_1.CivicPassMessageAction.TOKEN_REVOKED,\n  [types_1.GatewayStatus.FROZEN]: types_1.CivicPassMessageAction.TOKEN_FROZEN,\n  [types_1.GatewayStatus.REJECTED]: types_1.CivicPassMessageAction.TOKEN_REJECTED,\n  [types_1.GatewayStatus.LOCATION_NOT_SUPPORTED]: types_1.CivicPassMessageAction.FAILED_IP_CHECK,\n  [types_1.GatewayStatus.VPN_NOT_SUPPORTED]: types_1.CivicPassMessageAction.FAILED_VPN_CHECK,\n  [types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED]: types_1.CivicPassMessageAction.REFRESH,\n  [types_1.GatewayStatus.CHECKING]: types_1.CivicPassMessageAction.STATUS,\n  [types_1.GatewayStatus.NOT_REQUESTED]: types_1.CivicPassMessageAction.ISSUANCE,\n  [types_1.GatewayStatus.COLLECTING_USER_INFORMATION]: types_1.CivicPassMessageAction.ISSUANCE,\n  [types_1.GatewayStatus.VALIDATING_USER_INFORMATION]: types_1.CivicPassMessageAction.ISSUANCE,\n  [types_1.GatewayStatus.USER_INFORMATION_VALIDATED]: types_1.CivicPassMessageAction.ISSUANCE,\n  [types_1.GatewayStatus.USER_INFORMATION_REJECTED]: types_1.CivicPassMessageAction.ISSUANCE,\n  [types_1.ExtendedGatewayStatus.CONFIRM_OWNER_TRANSACTION]: types_1.CivicPassMessageAction.SIGN_TRANSACTION,\n  [types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION]: types_1.CivicPassMessageAction.AWAITING_TRANSACTION_CONFIRMATION,\n  [types_1.ExtendedGatewayStatus.CHAIN_TIMEOUT_ERROR]: types_1.CivicPassMessageAction.CHAIN_ERROR,\n  [types_1.ExtendedGatewayStatus.CHAIN_TRANSACTION_ERROR]: types_1.CivicPassMessageAction.CHAIN_ERROR\n};\nconst validationProcessToGatewayStatus = {\n  [types_1.ValidationStatus.COLLECTING]: types_1.GatewayStatus.COLLECTING_USER_INFORMATION,\n  [types_1.ValidationStatus.PROCESSING]: types_1.GatewayStatus.VALIDATING_USER_INFORMATION,\n  [types_1.ValidationStatus.IN_REVIEW]: types_1.GatewayStatus.VALIDATING_USER_INFORMATION,\n  [types_1.ValidationStatus.FAILED]: types_1.GatewayStatus.USER_INFORMATION_REJECTED,\n  [types_1.ValidationStatus.NOT_FOUND]: types_1.GatewayStatus.NOT_REQUESTED,\n  [types_1.ValidationStatus.COMPLETED]: types_1.GatewayStatus.USER_INFORMATION_VALIDATED\n};\n\nconst logDebug = function (message) {\n  let obj = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  return logger_1.default.debug(`[useCivicPass] ${message}`, obj);\n};\n\nconst logError = function (message) {\n  let obj = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  return logger_1.default.error(`[useCivicPass] ${message}`, obj);\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\n\nconst getCivicPassSrcUrl = (state, status, errorCode) => {\n  const {\n    redirectUrl: redirectUrl,\n    gatekeeperNetworkAddress: gatekeeperNetworkAddress,\n    stage: stage,\n    walletAddress: walletAddress,\n    civicPass: civicPass,\n    chainType: chainType,\n    ownerSigns: ownerSigns\n  } = state;\n\n  if (!gatekeeperNetworkAddress || !walletAddress) {\n    logError('Required properties not present', {\n      gatekeeperNetworkAddress: gatekeeperNetworkAddress,\n      walletAddress: walletAddress\n    });\n    throw new Error(`Required properties not present ${{\n      gatekeeperNetworkAddress: gatekeeperNetworkAddress,\n      walletAddress: walletAddress\n    }}`);\n  }\n\n  const civicPassSrcUrl = (0, config_1.getCivicPassEndpoint)(stage);\n  const url = new URL(civicPassSrcUrl);\n  const action = gatewayStatusToCivicPassAction[status];\n  const searchParams = new URLSearchParams(Object.assign(Object.assign(Object.assign({}, civicPass.requestPayload), {\n    redirectUrl: redirectUrl,\n    networkAddress: gatekeeperNetworkAddress,\n    action: action,\n    wallet: walletAddress,\n    chain: chainType,\n    ownerSigns: ownerSigns ? 'true' : 'false'\n  }), errorCode ? {\n    errorCode: errorCode\n  } : {}));\n  logDebug('Civic pass query params', {\n    searchParams: searchParams.toString(),\n    gatewayStatus: (0, status_1.statusDisplayValue)(status)\n  });\n  return `${url.href}?${searchParams.toString()}`;\n};\n\nconst reducer = (state, action) => {\n  var _a, _b, _c;\n\n  switch (action.type) {\n    case 'civicPass_owner_sends_chainTransactionError':\n      {\n        // set refresh token state to failed if in progress\n        const refreshTokenState = state.refreshTokenState === types_1.RefreshTokenState.IN_PROGRESS ? types_1.RefreshTokenState.FAILED : state.refreshTokenState;\n        return Object.assign(Object.assign({}, state), {\n          iframeMinimized: false,\n          renderIframe: true,\n          gatewayStatus: types_1.ExtendedGatewayStatus.CHAIN_TRANSACTION_ERROR,\n          refreshTokenState: refreshTokenState,\n          iframeSrcUrl: getCivicPassSrcUrl(state, types_1.ExtendedGatewayStatus.CHAIN_TRANSACTION_ERROR, (_a = action.payload) === null || _a === void 0 ? void 0 : _a.errorCode)\n        });\n      }\n\n    case 'civicPass_check_token_status':\n      {\n        return Object.assign(Object.assign({}, state), {\n          iframeMinimized: !((_b = state.options) === null || _b === void 0 ? void 0 : _b.autoShowModal),\n          renderIframe: true,\n          iframeSrcUrl: state.civicPass.status === types_1.CivicPassIssuanceStatus.REQUESTED ? state.iframeSrcUrl : getCivicPassSrcUrl(state, (0, utils_1.statusFromToken)(state, action.token))\n        });\n      }\n\n    case 'civicPass_check_status':\n      {\n        return Object.assign(Object.assign({}, state), {\n          iframeMinimized: true,\n          renderIframe: true,\n          gatewayStatus: types_1.GatewayStatus.CHECKING,\n          iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.CHECKING)\n        });\n      }\n\n    case 'civicPass_check_status_complete':\n      {\n        const {\n          payload: payload\n        } = action.payload;\n        const {\n          status: status\n        } = payload;\n        const gatewayStatus = validationProcessToGatewayStatus[status];\n        return Object.assign(Object.assign({}, state), {\n          iframeMinimized: true,\n          renderIframe: false,\n          gatewayStatus: gatewayStatus\n        });\n      }\n\n    case 'userInteraction_check_gatewayToken_status':\n      {\n        return Object.assign(Object.assign({}, state), {\n          iframeMinimized: false,\n          renderIframe: true,\n          iframeSrcUrl: state.civicPass.status === types_1.CivicPassIssuanceStatus.REQUESTED ? state.iframeSrcUrl : getCivicPassSrcUrl(state, (0, utils_1.statusFromToken)(state, action.token))\n        });\n      }\n\n    case 'civicPass_close':\n      {\n        const {\n          gatewayStatus: gatewayStatus\n        } = state;\n        const requiresRefresh = gatewayStatus === types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED || gatewayStatus === types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP || (0, status_1.mapStatus)(gatewayStatus) === types_1.GatewayStatus.ERROR && state.refreshTokenState === types_1.RefreshTokenState.FAILED; // keep iframe in mounted while civic pass is requested, or if we are showing the awaiting owner tx screen\n        // as the internal iframe state needs to be preserved\n\n        const renderIframe = state.civicPass.status === types_1.CivicPassIssuanceStatus.REQUESTED || gatewayStatus === types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION;\n        return Object.assign({}, renderIframe ? Object.assign(Object.assign({}, state), {\n          iframeMinimized: true,\n          renderIframe: renderIframe\n        }) : Object.assign(Object.assign({}, state), {\n          iframeMinimized: true,\n          renderIframe: renderIframe,\n          refreshTokenState: requiresRefresh ? state.refreshTokenState : types_1.RefreshTokenState.COMPLETED\n        }));\n      }\n\n    case 'civicPass_in_progress':\n      {\n        return Object.assign(Object.assign({}, state), {\n          gatewayStatus: types_1.GatewayStatus.COLLECTING_USER_INFORMATION,\n          renderIframe: true,\n          iframeMinimized: false,\n          civicPass: Object.assign(Object.assign({}, state.civicPass), {\n            status: types_1.CivicPassIssuanceStatus.REQUESTED\n          })\n        });\n      }\n\n    case 'civicPass_issuance_success':\n      {\n        const {\n          ownerSigns: ownerSigns\n        } = state;\n        const {\n          payload: payload,\n          requiresProofOfWalletOwnership: requiresProofOfWalletOwnership\n        } = action.payload;\n        const shouldRequestPowo = ownerSigns ? false : requiresProofOfWalletOwnership; // Show POWO or in review for non ownerSigns depending on resulting flag\n\n        const gatekeeperSignsStatus = shouldRequestPowo ? types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP : types_1.GatewayStatus.IN_REVIEW; // Show confirm owner transaction screen if ownerSigns is true\n\n        const gatewayStatus = ownerSigns ? types_1.ExtendedGatewayStatus.CONFIRM_OWNER_TRANSACTION : gatekeeperSignsStatus;\n        return Object.assign(Object.assign({}, state), {\n          gatewayStatus: gatewayStatus,\n          ownerTransactionConfirmed: false,\n          renderIframe: true,\n          iframeMinimized: false,\n          powoRequested: 'solana',\n          iframeSrcUrl: getCivicPassSrcUrl(state, gatewayStatus),\n          civicPass: Object.assign(Object.assign({}, state.civicPass), {\n            status: types_1.CivicPassIssuanceStatus.VERIFIED,\n            responsePayload: {\n              [types_1.CivicPassMessageAction.ISSUANCE]: {\n                payload: payload,\n                requiresProofOfWalletOwnership: shouldRequestPowo\n              }\n            }\n          })\n        });\n      }\n\n    case 'civicPass_issuance_failure':\n      return Object.assign(Object.assign({}, (0, utils_1.resetState)(state)), {\n        iframeMinimized: false,\n        renderIframe: true,\n        gatewayStatus: types_1.GatewayStatus.ERROR,\n        iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.ERROR),\n        civicPass: Object.assign(Object.assign({}, state.civicPass), {\n          responsePayload: undefined\n        })\n      });\n\n    case 'civicPass_requested_retries_exhausted':\n      return Object.assign(Object.assign({}, (0, utils_1.resetState)(state)), {\n        refreshTokenState: types_1.RefreshTokenState.NOT_REQUIRED,\n        iframeMinimized: false,\n        renderIframe: true,\n        gatewayStatus: types_1.GatewayStatus.ERROR,\n        iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.ERROR)\n      });\n\n    case 'civicPass_error_user_retry':\n      {\n        // retry either issuance or refresh depending on the refresh token state\n        const gatewayStatus = state.refreshTokenState === types_1.RefreshTokenState.FAILED ? types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED : types_1.GatewayStatus.NOT_REQUESTED;\n        return Object.assign(Object.assign({}, gatewayStatus === types_1.GatewayStatus.NOT_REQUESTED ? (0, utils_1.resetState)(state) : state), {\n          iframeMinimized: false,\n          renderIframe: true,\n          gatewayStatus: gatewayStatus,\n          iframeSrcUrl: getCivicPassSrcUrl(state, gatewayStatus),\n          walletPowoInProgress: false,\n          ownerTransactionConfirmed: false\n        });\n      }\n\n    case 'civicPass_issuance_cancelled':\n      return Object.assign(Object.assign({}, (0, utils_1.resetState)(state)), {\n        gatewayStatus: types_1.GatewayStatus.NOT_REQUESTED\n      });\n\n    case 'civicPass_refresh_success':\n      {\n        const {\n          ownerSigns: ownerSigns\n        } = state;\n        const {\n          payload: payload,\n          requiresProofOfWalletOwnership: requiresProofOfWalletOwnership\n        } = action.payload;\n        const shouldRequestPowo = ownerSigns ? false : requiresProofOfWalletOwnership;\n        const gatewayStatus = shouldRequestPowo ? types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP : types_1.GatewayStatus.IN_REVIEW;\n        return Object.assign(Object.assign({}, state), {\n          gatewayStatus: gatewayStatus,\n          renderIframe: true,\n          iframeMinimized: false,\n          iframeSrcUrl: getCivicPassSrcUrl(state, gatewayStatus),\n          refreshTokenState: types_1.RefreshTokenState.IN_PROGRESS,\n          civicPass: Object.assign(Object.assign({}, state.civicPass), {\n            responsePayload: {\n              [types_1.CivicPassMessageAction.REFRESH]: {\n                payload: payload,\n                requiresProofOfWalletOwnership: shouldRequestPowo\n              }\n            }\n          })\n        });\n      }\n\n    case 'civicPass_refresh_cancelled':\n      return Object.assign(Object.assign({}, state), {\n        refreshTokenState: types_1.RefreshTokenState.CANCELLED,\n        gatewayStatus: types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED\n      });\n\n    case 'civicPass_refresh_failure':\n      return Object.assign(Object.assign({}, state), {\n        refreshTokenState: types_1.RefreshTokenState.FAILED,\n        gatewayStatus: types_1.GatewayStatus.ERROR,\n        iframeMinimized: false,\n        renderIframe: true,\n        iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.ERROR),\n        civicPass: Object.assign(Object.assign({}, state.civicPass), {\n          responsePayload: undefined\n        })\n      });\n\n    case 'civicPass_location_not_supported':\n      return Object.assign(Object.assign({}, state), {\n        iframeMinimized: true,\n        renderIframe: false,\n        gatewayStatus: state.gatewayStatus,\n        refreshTokenState: state.gatekeeperRecordState === types_1.GatekeeperAPIStatus.ISSUED_LOCATION_NOT_SUPPORTED ? types_1.RefreshTokenState.REQUIRES_POWO : state.refreshTokenState\n      });\n\n    case 'civicPass_vpn_not_supported':\n      return Object.assign(Object.assign({}, state), {\n        iframeMinimized: true,\n        renderIframe: false,\n        gatewayStatus: state.gatewayStatus\n      });\n\n    case 'civicPass_owner_transaction_confirmed':\n      return Object.assign(Object.assign({}, state), {\n        ownerTransactionConfirmed: true\n      });\n\n    case 'civicPass_awaiting_owner_transaction':\n      return Object.assign(Object.assign({}, state), {\n        iframeMinimized: !((_c = state.options) === null || _c === void 0 ? void 0 : _c.autoShowModal),\n        renderIframe: true,\n        gatewayStatus: types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION,\n        iframeSrcUrl: getCivicPassSrcUrl(state, types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION)\n      });\n\n    case 'civicPass_owner_transaction_timeout':\n      return Object.assign(Object.assign({}, state), {\n        iframeMinimized: false,\n        renderIframe: true,\n        gatewayStatus: types_1.ExtendedGatewayStatus.CHAIN_TIMEOUT_ERROR,\n        iframeSrcUrl: getCivicPassSrcUrl(state, types_1.ExtendedGatewayStatus.CHAIN_TIMEOUT_ERROR)\n      });\n\n    default:\n      return state;\n  }\n};\n\nexports.reducer = reducer;\n\nconst useCivicPass = (_ref, state, dispatch) => {\n  let {\n    wallet: wallet\n  } = _ref;\n  const {\n    gatekeeperRecordState: gatekeeperRecordState\n  } = state;\n\n  const getActionForIssuanceResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'civicPass_issuance_success',\n        payload: response\n      },\n      [types_1.CivicPassMessageEventResult.FAILURE]: {\n        type: 'civicPass_issuance_failure'\n      },\n      [types_1.CivicPassMessageEventResult.CANCELLED]: {\n        type: 'civicPass_issuance_cancelled'\n      },\n      [types_1.CivicPassMessageEventResult.IN_PROGRESS]: {\n        type: 'civicPass_in_progress'\n      }\n    };\n    return actions[response.event];\n  };\n\n  const getActionForRefreshResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'civicPass_refresh_success',\n        payload: response\n      },\n      [types_1.CivicPassMessageEventResult.CANCELLED]: {\n        type: 'civicPass_refresh_cancelled'\n      },\n      [types_1.CivicPassMessageEventResult.FAILURE]: {\n        type: 'civicPass_refresh_failure'\n      }\n    };\n    return actions[response.event];\n  };\n\n  const getActionForPowoResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'powoComplete'\n      }\n    };\n    return actions[response.event];\n  };\n\n  const getActionForLocationNotSupportedResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'civicPass_location_not_supported'\n      }\n    };\n    return actions[response.event];\n  };\n\n  const getActionForVpnNotSupportedResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'civicPass_vpn_not_supported'\n      }\n    };\n    return actions[response.event];\n  };\n\n  const getActionForStaticResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'civicPass_close'\n      },\n      [types_1.CivicPassMessageEventResult.FAILURE]: {\n        type: 'civicPass_error_user_retry'\n      }\n    };\n    const returnAction = actions[response.event];\n    return returnAction;\n  };\n\n  const getActionForStatusResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'civicPass_check_status_complete',\n        payload: response\n      }\n    };\n    return actions[response.event];\n  };\n\n  const getActionForSignTransactionResponse = response => {\n    const actions = {\n      [types_1.CivicPassMessageEventResult.SUCCESS]: {\n        type: 'civicPass_owner_transaction_confirmed'\n      }\n    };\n    return actions[response.event];\n  };\n\n  const dispatchComplianceEventResult = response => {\n    const actions = {\n      [types_1.CivicPassMessageAction.ISSUANCE]: getActionForIssuanceResponse(response),\n      [types_1.CivicPassMessageAction.PROOF_OF_WALLET_OWNERSHIP]: getActionForPowoResponse(response),\n      [types_1.CivicPassMessageAction.TOKEN_IN_REVIEW]: getActionForStaticResponse(response),\n      [types_1.CivicPassMessageAction.TOKEN_ACTIVE]: getActionForStaticResponse(response),\n      [types_1.CivicPassMessageAction.TOKEN_FROZEN]: getActionForStaticResponse(response),\n      [types_1.CivicPassMessageAction.TOKEN_REJECTED]: getActionForStaticResponse(response),\n      [types_1.CivicPassMessageAction.TOKEN_REVOKED]: getActionForStaticResponse(response),\n      [types_1.CivicPassMessageAction.FAILED_IP_CHECK]: getActionForLocationNotSupportedResponse(response),\n      [types_1.CivicPassMessageAction.FAILED_VPN_CHECK]: getActionForVpnNotSupportedResponse(response),\n      [types_1.CivicPassMessageAction.REFRESH]: getActionForRefreshResponse(response),\n      [types_1.CivicPassMessageAction.STATUS]: getActionForStatusResponse(response),\n      [types_1.CivicPassMessageAction.ERROR]: getActionForStaticResponse(response),\n      [types_1.CivicPassMessageAction.CHAIN_ERROR]: getActionForStaticResponse(response),\n      [types_1.CivicPassMessageAction.SIGN_TRANSACTION]: getActionForSignTransactionResponse(response)\n    };\n    const action = actions[response.action];\n\n    if (action) {\n      logDebug('Successfully processed compliance event with action', action);\n      dispatch(action);\n    }\n  };\n  /**\n   * Listen for post messages from the compliance iframe and dispatch events\n   * based on the event type\n   */\n\n\n  (0, react_1.useEffect)(() => {\n    if (wallet && wallet.publicKey) {\n      logDebug('Current state', state);\n\n      const handler = async response => {\n        dispatchComplianceEventResult(response.data);\n      };\n\n      window.addEventListener('message', handler);\n      return () => {\n        logDebug('Removing event listener for compliance');\n        return window.removeEventListener('message', handler);\n      };\n    }\n\n    return () => {};\n  }, []);\n  /**\n   * We do not have a token and user is connecting from an unsupported country,\n   * so we show the country not supported screen\n   */\n\n  (0, react_1.useEffect)(() => {\n    if (gatekeeperRecordState === types_1.GatekeeperAPIStatus.LOCATION_NOT_SUPPORTED || gatekeeperRecordState === types_1.GatekeeperAPIStatus.VPN_NOT_SUPPORTED) {\n      dispatch({\n        type: 'civicPass_check_token_status'\n      });\n    }\n  }, [gatekeeperRecordState]);\n  /**\n   * Check for the ongoing KYC status\n   */\n\n  (0, react_1.useEffect)(() => {\n    if (gatekeeperRecordState === types_1.GatekeeperAPIStatus.NOT_REQUESTED) {\n      dispatch({\n        type: 'civicPass_check_status'\n      });\n    }\n  }, [gatekeeperRecordState]);\n  return {\n    dispatchComplianceEventResult: dispatchComplianceEventResult\n  };\n};\n\nexports.default = useCivicPass;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","reducer","react_1","require","status_1","logger_1","types_1","config_1","utils_1","gatewayStatusToCivicPassAction","GatewayStatus","PROOF_OF_WALLET_OWNERSHIP","CivicPassMessageAction","IN_REVIEW","TOKEN_IN_REVIEW","ERROR","ACTIVE","TOKEN_ACTIVE","REVOKED","TOKEN_REVOKED","FROZEN","TOKEN_FROZEN","REJECTED","TOKEN_REJECTED","LOCATION_NOT_SUPPORTED","FAILED_IP_CHECK","VPN_NOT_SUPPORTED","FAILED_VPN_CHECK","REFRESH_TOKEN_REQUIRED","REFRESH","CHECKING","STATUS","NOT_REQUESTED","ISSUANCE","COLLECTING_USER_INFORMATION","VALIDATING_USER_INFORMATION","USER_INFORMATION_VALIDATED","USER_INFORMATION_REJECTED","ExtendedGatewayStatus","CONFIRM_OWNER_TRANSACTION","SIGN_TRANSACTION","AWAITING_OWNER_TRANSACTION","AWAITING_TRANSACTION_CONFIRMATION","CHAIN_TIMEOUT_ERROR","CHAIN_ERROR","CHAIN_TRANSACTION_ERROR","validationProcessToGatewayStatus","ValidationStatus","COLLECTING","PROCESSING","FAILED","NOT_FOUND","COMPLETED","logDebug","message","obj","default","debug","logError","error","getCivicPassSrcUrl","state","status","errorCode","redirectUrl","gatekeeperNetworkAddress","stage","walletAddress","civicPass","chainType","ownerSigns","Error","civicPassSrcUrl","getCivicPassEndpoint","url","URL","action","searchParams","URLSearchParams","assign","requestPayload","networkAddress","wallet","chain","toString","gatewayStatus","statusDisplayValue","href","_a","_b","_c","type","refreshTokenState","RefreshTokenState","IN_PROGRESS","iframeMinimized","renderIframe","iframeSrcUrl","payload","options","autoShowModal","CivicPassIssuanceStatus","REQUESTED","statusFromToken","token","requiresRefresh","mapStatus","requiresProofOfWalletOwnership","shouldRequestPowo","gatekeeperSignsStatus","ownerTransactionConfirmed","powoRequested","VERIFIED","responsePayload","resetState","undefined","NOT_REQUIRED","walletPowoInProgress","CANCELLED","gatekeeperRecordState","GatekeeperAPIStatus","ISSUED_LOCATION_NOT_SUPPORTED","REQUIRES_POWO","useCivicPass","dispatch","getActionForIssuanceResponse","response","actions","CivicPassMessageEventResult","SUCCESS","FAILURE","event","getActionForRefreshResponse","getActionForPowoResponse","getActionForLocationNotSupportedResponse","getActionForVpnNotSupportedResponse","getActionForStaticResponse","returnAction","getActionForStatusResponse","getActionForSignTransactionResponse","dispatchComplianceEventResult","useEffect","publicKey","handler","data","window","addEventListener","removeEventListener"],"sources":["D:/software/o5o BNB/o5o-staking-frontend/node_modules/@civic/common-gateway-react/dist/esm/useHooks/useCivicPass.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reducer = void 0;\nconst react_1 = require(\"react\");\nconst status_1 = require(\"../utils/status\");\nconst logger_1 = __importDefault(require(\"../logger\"));\nconst types_1 = require(\"../types\");\nconst config_1 = require(\"../config\");\nconst utils_1 = require(\"../useReducer/utils\");\nconst gatewayStatusToCivicPassAction = {\n    [types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP]: types_1.CivicPassMessageAction.PROOF_OF_WALLET_OWNERSHIP,\n    [types_1.GatewayStatus.IN_REVIEW]: types_1.CivicPassMessageAction.TOKEN_IN_REVIEW,\n    [types_1.GatewayStatus.ERROR]: types_1.CivicPassMessageAction.ERROR,\n    [types_1.GatewayStatus.ACTIVE]: types_1.CivicPassMessageAction.TOKEN_ACTIVE,\n    [types_1.GatewayStatus.REVOKED]: types_1.CivicPassMessageAction.TOKEN_REVOKED,\n    [types_1.GatewayStatus.FROZEN]: types_1.CivicPassMessageAction.TOKEN_FROZEN,\n    [types_1.GatewayStatus.REJECTED]: types_1.CivicPassMessageAction.TOKEN_REJECTED,\n    [types_1.GatewayStatus.LOCATION_NOT_SUPPORTED]: types_1.CivicPassMessageAction.FAILED_IP_CHECK,\n    [types_1.GatewayStatus.VPN_NOT_SUPPORTED]: types_1.CivicPassMessageAction.FAILED_VPN_CHECK,\n    [types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED]: types_1.CivicPassMessageAction.REFRESH,\n    [types_1.GatewayStatus.CHECKING]: types_1.CivicPassMessageAction.STATUS,\n    [types_1.GatewayStatus.NOT_REQUESTED]: types_1.CivicPassMessageAction.ISSUANCE,\n    [types_1.GatewayStatus.COLLECTING_USER_INFORMATION]: types_1.CivicPassMessageAction.ISSUANCE,\n    [types_1.GatewayStatus.VALIDATING_USER_INFORMATION]: types_1.CivicPassMessageAction.ISSUANCE,\n    [types_1.GatewayStatus.USER_INFORMATION_VALIDATED]: types_1.CivicPassMessageAction.ISSUANCE,\n    [types_1.GatewayStatus.USER_INFORMATION_REJECTED]: types_1.CivicPassMessageAction.ISSUANCE,\n    [types_1.ExtendedGatewayStatus.CONFIRM_OWNER_TRANSACTION]: types_1.CivicPassMessageAction.SIGN_TRANSACTION,\n    [types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION]: types_1.CivicPassMessageAction.AWAITING_TRANSACTION_CONFIRMATION,\n    [types_1.ExtendedGatewayStatus.CHAIN_TIMEOUT_ERROR]: types_1.CivicPassMessageAction.CHAIN_ERROR,\n    [types_1.ExtendedGatewayStatus.CHAIN_TRANSACTION_ERROR]: types_1.CivicPassMessageAction.CHAIN_ERROR,\n};\nconst validationProcessToGatewayStatus = {\n    [types_1.ValidationStatus.COLLECTING]: types_1.GatewayStatus.COLLECTING_USER_INFORMATION,\n    [types_1.ValidationStatus.PROCESSING]: types_1.GatewayStatus.VALIDATING_USER_INFORMATION,\n    [types_1.ValidationStatus.IN_REVIEW]: types_1.GatewayStatus.VALIDATING_USER_INFORMATION,\n    [types_1.ValidationStatus.FAILED]: types_1.GatewayStatus.USER_INFORMATION_REJECTED,\n    [types_1.ValidationStatus.NOT_FOUND]: types_1.GatewayStatus.NOT_REQUESTED,\n    [types_1.ValidationStatus.COMPLETED]: types_1.GatewayStatus.USER_INFORMATION_VALIDATED,\n};\nconst logDebug = (message, obj = null) => logger_1.default.debug(`[useCivicPass] ${message}`, obj);\nconst logError = (message, obj = null) => logger_1.default.error(`[useCivicPass] ${message}`, obj);\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nconst getCivicPassSrcUrl = (state, status, errorCode) => {\n    const { redirectUrl, gatekeeperNetworkAddress, stage, walletAddress, civicPass, chainType, ownerSigns } = state;\n    if (!gatekeeperNetworkAddress || !walletAddress) {\n        logError('Required properties not present', { gatekeeperNetworkAddress, walletAddress });\n        throw new Error(`Required properties not present ${{ gatekeeperNetworkAddress, walletAddress }}`);\n    }\n    const civicPassSrcUrl = (0, config_1.getCivicPassEndpoint)(stage);\n    const url = new URL(civicPassSrcUrl);\n    const action = gatewayStatusToCivicPassAction[status];\n    const searchParams = new URLSearchParams(Object.assign(Object.assign(Object.assign({}, civicPass.requestPayload), { redirectUrl, networkAddress: gatekeeperNetworkAddress, action, wallet: walletAddress, chain: chainType, ownerSigns: ownerSigns ? 'true' : 'false' }), (errorCode ? { errorCode } : {})));\n    logDebug('Civic pass query params', {\n        searchParams: searchParams.toString(),\n        gatewayStatus: (0, status_1.statusDisplayValue)(status),\n    });\n    return `${url.href}?${searchParams.toString()}`;\n};\nconst reducer = (state, action) => {\n    var _a, _b, _c;\n    switch (action.type) {\n        case 'civicPass_owner_sends_chainTransactionError': {\n            // set refresh token state to failed if in progress\n            const refreshTokenState = state.refreshTokenState === types_1.RefreshTokenState.IN_PROGRESS ? types_1.RefreshTokenState.FAILED : state.refreshTokenState;\n            return Object.assign(Object.assign({}, state), { iframeMinimized: false, renderIframe: true, gatewayStatus: types_1.ExtendedGatewayStatus.CHAIN_TRANSACTION_ERROR, refreshTokenState, iframeSrcUrl: getCivicPassSrcUrl(state, types_1.ExtendedGatewayStatus.CHAIN_TRANSACTION_ERROR, (_a = action.payload) === null || _a === void 0 ? void 0 : _a.errorCode) });\n        }\n        case 'civicPass_check_token_status': {\n            return Object.assign(Object.assign({}, state), { iframeMinimized: !((_b = state.options) === null || _b === void 0 ? void 0 : _b.autoShowModal), renderIframe: true, iframeSrcUrl: state.civicPass.status === types_1.CivicPassIssuanceStatus.REQUESTED\n                    ? state.iframeSrcUrl\n                    : getCivicPassSrcUrl(state, (0, utils_1.statusFromToken)(state, action.token)) });\n        }\n        case 'civicPass_check_status': {\n            return Object.assign(Object.assign({}, state), { iframeMinimized: true, renderIframe: true, gatewayStatus: types_1.GatewayStatus.CHECKING, iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.CHECKING) });\n        }\n        case 'civicPass_check_status_complete': {\n            const { payload } = action.payload;\n            const { status } = payload;\n            const gatewayStatus = validationProcessToGatewayStatus[status];\n            return Object.assign(Object.assign({}, state), { iframeMinimized: true, renderIframe: false, gatewayStatus });\n        }\n        case 'userInteraction_check_gatewayToken_status': {\n            return Object.assign(Object.assign({}, state), { iframeMinimized: false, renderIframe: true, iframeSrcUrl: state.civicPass.status === types_1.CivicPassIssuanceStatus.REQUESTED\n                    ? state.iframeSrcUrl\n                    : getCivicPassSrcUrl(state, (0, utils_1.statusFromToken)(state, action.token)) });\n        }\n        case 'civicPass_close': {\n            const { gatewayStatus } = state;\n            const requiresRefresh = gatewayStatus === types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED ||\n                gatewayStatus === types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP ||\n                ((0, status_1.mapStatus)(gatewayStatus) === types_1.GatewayStatus.ERROR && state.refreshTokenState === types_1.RefreshTokenState.FAILED);\n            // keep iframe in mounted while civic pass is requested, or if we are showing the awaiting owner tx screen\n            // as the internal iframe state needs to be preserved\n            const renderIframe = state.civicPass.status === types_1.CivicPassIssuanceStatus.REQUESTED ||\n                gatewayStatus === types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION;\n            return Object.assign({}, (renderIframe\n                ? Object.assign(Object.assign({}, state), { iframeMinimized: true, renderIframe }) : Object.assign(Object.assign({}, state), { iframeMinimized: true, renderIframe, refreshTokenState: requiresRefresh ? state.refreshTokenState : types_1.RefreshTokenState.COMPLETED })));\n        }\n        case 'civicPass_in_progress': {\n            return Object.assign(Object.assign({}, state), { gatewayStatus: types_1.GatewayStatus.COLLECTING_USER_INFORMATION, renderIframe: true, iframeMinimized: false, civicPass: Object.assign(Object.assign({}, state.civicPass), { status: types_1.CivicPassIssuanceStatus.REQUESTED }) });\n        }\n        case 'civicPass_issuance_success': {\n            const { ownerSigns } = state;\n            const { payload, requiresProofOfWalletOwnership } = action.payload;\n            const shouldRequestPowo = ownerSigns ? false : requiresProofOfWalletOwnership;\n            // Show POWO or in review for non ownerSigns depending on resulting flag\n            const gatekeeperSignsStatus = shouldRequestPowo\n                ? types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP\n                : types_1.GatewayStatus.IN_REVIEW;\n            // Show confirm owner transaction screen if ownerSigns is true\n            const gatewayStatus = ownerSigns ? types_1.ExtendedGatewayStatus.CONFIRM_OWNER_TRANSACTION : gatekeeperSignsStatus;\n            return Object.assign(Object.assign({}, state), { gatewayStatus, ownerTransactionConfirmed: false, renderIframe: true, iframeMinimized: false, powoRequested: 'solana', iframeSrcUrl: getCivicPassSrcUrl(state, gatewayStatus), civicPass: Object.assign(Object.assign({}, state.civicPass), { status: types_1.CivicPassIssuanceStatus.VERIFIED, responsePayload: {\n                        [types_1.CivicPassMessageAction.ISSUANCE]: {\n                            payload,\n                            requiresProofOfWalletOwnership: shouldRequestPowo,\n                        },\n                    } }) });\n        }\n        case 'civicPass_issuance_failure':\n            return Object.assign(Object.assign({}, (0, utils_1.resetState)(state)), { iframeMinimized: false, renderIframe: true, gatewayStatus: types_1.GatewayStatus.ERROR, iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.ERROR), civicPass: Object.assign(Object.assign({}, state.civicPass), { responsePayload: undefined }) });\n        case 'civicPass_requested_retries_exhausted':\n            return Object.assign(Object.assign({}, (0, utils_1.resetState)(state)), { refreshTokenState: types_1.RefreshTokenState.NOT_REQUIRED, iframeMinimized: false, renderIframe: true, gatewayStatus: types_1.GatewayStatus.ERROR, iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.ERROR) });\n        case 'civicPass_error_user_retry': {\n            // retry either issuance or refresh depending on the refresh token state\n            const gatewayStatus = state.refreshTokenState === types_1.RefreshTokenState.FAILED\n                ? types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED\n                : types_1.GatewayStatus.NOT_REQUESTED;\n            return Object.assign(Object.assign({}, (gatewayStatus === types_1.GatewayStatus.NOT_REQUESTED ? (0, utils_1.resetState)(state) : state)), { iframeMinimized: false, renderIframe: true, gatewayStatus, iframeSrcUrl: getCivicPassSrcUrl(state, gatewayStatus), walletPowoInProgress: false, ownerTransactionConfirmed: false });\n        }\n        case 'civicPass_issuance_cancelled':\n            return Object.assign(Object.assign({}, (0, utils_1.resetState)(state)), { gatewayStatus: types_1.GatewayStatus.NOT_REQUESTED });\n        case 'civicPass_refresh_success': {\n            const { ownerSigns } = state;\n            const { payload, requiresProofOfWalletOwnership } = action.payload;\n            const shouldRequestPowo = ownerSigns ? false : requiresProofOfWalletOwnership;\n            const gatewayStatus = shouldRequestPowo ? types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP : types_1.GatewayStatus.IN_REVIEW;\n            return Object.assign(Object.assign({}, state), { gatewayStatus, renderIframe: true, iframeMinimized: false, iframeSrcUrl: getCivicPassSrcUrl(state, gatewayStatus), refreshTokenState: types_1.RefreshTokenState.IN_PROGRESS, civicPass: Object.assign(Object.assign({}, state.civicPass), { responsePayload: {\n                        [types_1.CivicPassMessageAction.REFRESH]: {\n                            payload,\n                            requiresProofOfWalletOwnership: shouldRequestPowo,\n                        },\n                    } }) });\n        }\n        case 'civicPass_refresh_cancelled':\n            return Object.assign(Object.assign({}, state), { refreshTokenState: types_1.RefreshTokenState.CANCELLED, gatewayStatus: types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED });\n        case 'civicPass_refresh_failure':\n            return Object.assign(Object.assign({}, state), { refreshTokenState: types_1.RefreshTokenState.FAILED, gatewayStatus: types_1.GatewayStatus.ERROR, iframeMinimized: false, renderIframe: true, iframeSrcUrl: getCivicPassSrcUrl(state, types_1.GatewayStatus.ERROR), civicPass: Object.assign(Object.assign({}, state.civicPass), { responsePayload: undefined }) });\n        case 'civicPass_location_not_supported':\n            return Object.assign(Object.assign({}, state), { iframeMinimized: true, renderIframe: false, gatewayStatus: state.gatewayStatus, refreshTokenState: state.gatekeeperRecordState === types_1.GatekeeperAPIStatus.ISSUED_LOCATION_NOT_SUPPORTED\n                    ? types_1.RefreshTokenState.REQUIRES_POWO\n                    : state.refreshTokenState });\n        case 'civicPass_vpn_not_supported':\n            return Object.assign(Object.assign({}, state), { iframeMinimized: true, renderIframe: false, gatewayStatus: state.gatewayStatus });\n        case 'civicPass_owner_transaction_confirmed':\n            return Object.assign(Object.assign({}, state), { ownerTransactionConfirmed: true });\n        case 'civicPass_awaiting_owner_transaction':\n            return Object.assign(Object.assign({}, state), { iframeMinimized: !((_c = state.options) === null || _c === void 0 ? void 0 : _c.autoShowModal), renderIframe: true, gatewayStatus: types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION, iframeSrcUrl: getCivicPassSrcUrl(state, types_1.ExtendedGatewayStatus.AWAITING_OWNER_TRANSACTION) });\n        case 'civicPass_owner_transaction_timeout':\n            return Object.assign(Object.assign({}, state), { iframeMinimized: false, renderIframe: true, gatewayStatus: types_1.ExtendedGatewayStatus.CHAIN_TIMEOUT_ERROR, iframeSrcUrl: getCivicPassSrcUrl(state, types_1.ExtendedGatewayStatus.CHAIN_TIMEOUT_ERROR) });\n        default:\n            return state;\n    }\n};\nexports.reducer = reducer;\nconst useCivicPass = ({ wallet }, state, dispatch) => {\n    const { gatekeeperRecordState } = state;\n    const getActionForIssuanceResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'civicPass_issuance_success',\n                payload: response,\n            },\n            [types_1.CivicPassMessageEventResult.FAILURE]: {\n                type: 'civicPass_issuance_failure',\n            },\n            [types_1.CivicPassMessageEventResult.CANCELLED]: {\n                type: 'civicPass_issuance_cancelled',\n            },\n            [types_1.CivicPassMessageEventResult.IN_PROGRESS]: {\n                type: 'civicPass_in_progress',\n            },\n        };\n        return actions[response.event];\n    };\n    const getActionForRefreshResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'civicPass_refresh_success',\n                payload: response,\n            },\n            [types_1.CivicPassMessageEventResult.CANCELLED]: {\n                type: 'civicPass_refresh_cancelled',\n            },\n            [types_1.CivicPassMessageEventResult.FAILURE]: {\n                type: 'civicPass_refresh_failure',\n            },\n        };\n        return actions[response.event];\n    };\n    const getActionForPowoResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'powoComplete',\n            },\n        };\n        return actions[response.event];\n    };\n    const getActionForLocationNotSupportedResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'civicPass_location_not_supported',\n            },\n        };\n        return actions[response.event];\n    };\n    const getActionForVpnNotSupportedResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'civicPass_vpn_not_supported',\n            },\n        };\n        return actions[response.event];\n    };\n    const getActionForStaticResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'civicPass_close',\n            },\n            [types_1.CivicPassMessageEventResult.FAILURE]: {\n                type: 'civicPass_error_user_retry',\n            },\n        };\n        const returnAction = actions[response.event];\n        return returnAction;\n    };\n    const getActionForStatusResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'civicPass_check_status_complete',\n                payload: response,\n            },\n        };\n        return actions[response.event];\n    };\n    const getActionForSignTransactionResponse = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageEventResult.SUCCESS]: {\n                type: 'civicPass_owner_transaction_confirmed',\n            },\n        };\n        return actions[response.event];\n    };\n    const dispatchComplianceEventResult = (response) => {\n        const actions = {\n            [types_1.CivicPassMessageAction.ISSUANCE]: getActionForIssuanceResponse(response),\n            [types_1.CivicPassMessageAction.PROOF_OF_WALLET_OWNERSHIP]: getActionForPowoResponse(response),\n            [types_1.CivicPassMessageAction.TOKEN_IN_REVIEW]: getActionForStaticResponse(response),\n            [types_1.CivicPassMessageAction.TOKEN_ACTIVE]: getActionForStaticResponse(response),\n            [types_1.CivicPassMessageAction.TOKEN_FROZEN]: getActionForStaticResponse(response),\n            [types_1.CivicPassMessageAction.TOKEN_REJECTED]: getActionForStaticResponse(response),\n            [types_1.CivicPassMessageAction.TOKEN_REVOKED]: getActionForStaticResponse(response),\n            [types_1.CivicPassMessageAction.FAILED_IP_CHECK]: getActionForLocationNotSupportedResponse(response),\n            [types_1.CivicPassMessageAction.FAILED_VPN_CHECK]: getActionForVpnNotSupportedResponse(response),\n            [types_1.CivicPassMessageAction.REFRESH]: getActionForRefreshResponse(response),\n            [types_1.CivicPassMessageAction.STATUS]: getActionForStatusResponse(response),\n            [types_1.CivicPassMessageAction.ERROR]: getActionForStaticResponse(response),\n            [types_1.CivicPassMessageAction.CHAIN_ERROR]: getActionForStaticResponse(response),\n            [types_1.CivicPassMessageAction.SIGN_TRANSACTION]: getActionForSignTransactionResponse(response),\n        };\n        const action = actions[response.action];\n        if (action) {\n            logDebug('Successfully processed compliance event with action', action);\n            dispatch(action);\n        }\n    };\n    /**\n     * Listen for post messages from the compliance iframe and dispatch events\n     * based on the event type\n     */\n    (0, react_1.useEffect)(() => {\n        if (wallet && wallet.publicKey) {\n            logDebug('Current state', state);\n            const handler = async (response) => {\n                dispatchComplianceEventResult(response.data);\n            };\n            window.addEventListener('message', handler);\n            return () => {\n                logDebug('Removing event listener for compliance');\n                return window.removeEventListener('message', handler);\n            };\n        }\n        return () => { };\n    }, []);\n    /**\n     * We do not have a token and user is connecting from an unsupported country,\n     * so we show the country not supported screen\n     */\n    (0, react_1.useEffect)(() => {\n        if (gatekeeperRecordState === types_1.GatekeeperAPIStatus.LOCATION_NOT_SUPPORTED ||\n            gatekeeperRecordState === types_1.GatekeeperAPIStatus.VPN_NOT_SUPPORTED) {\n            dispatch({ type: 'civicPass_check_token_status' });\n        }\n    }, [gatekeeperRecordState]);\n    /**\n     * Check for the ongoing KYC status\n     */\n    (0, react_1.useEffect)(() => {\n        if (gatekeeperRecordState === types_1.GatekeeperAPIStatus.NOT_REQUESTED) {\n            dispatch({ type: 'civicPass_check_status' });\n        }\n    }, [gatekeeperRecordState]);\n    return { dispatchComplianceEventResult };\n};\nexports.default = useCivicPass;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}