{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.deserialize = void 0;\n\nconst beet = __importStar(require(\"@metaplex-foundation/beet\"));\n\nconst beetSolana = __importStar(require(\"@metaplex-foundation/beet-solana\"));\n\nconst Metadata_1 = require(\"../generated/accounts/Metadata\");\n\nconst Collection_1 = require(\"../generated/types/Collection\");\n\nconst CollectionDetails_1 = require(\"../generated/types/CollectionDetails\");\n\nconst Data_1 = require(\"../generated/types/Data\");\n\nconst Key_1 = require(\"../generated/types/Key\");\n\nconst TokenStandard_1 = require(\"../generated/types/TokenStandard\");\n\nconst Uses_1 = require(\"../generated/types/Uses\");\n\nconst NONE_BYTE_SIZE = beet.coptionNone('').byteSize;\n\nfunction deserialize(buf) {\n  let offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  let cursor = offset;\n  const key = Key_1.keyBeet.read(buf, cursor);\n  cursor += Key_1.keyBeet.byteSize;\n  const updateAuthority = beetSolana.publicKey.read(buf, cursor);\n  cursor += beetSolana.publicKey.byteSize;\n  const mint = beetSolana.publicKey.read(buf, cursor);\n  cursor += beetSolana.publicKey.byteSize;\n  const [data, dataDelta] = Data_1.dataBeet.deserialize(buf, cursor);\n  cursor = dataDelta;\n  const primarySaleHappened = beet.bool.read(buf, cursor);\n  cursor += beet.bool.byteSize;\n  const isMutable = beet.bool.read(buf, cursor);\n  cursor += beet.bool.byteSize;\n  const editionNonceBeet = beet.coption(beet.u8).toFixedFromData(buf, cursor);\n  const editionNonce = editionNonceBeet.read(buf, cursor);\n  cursor += editionNonceBeet.byteSize;\n  const [tokenStandard, tokenDelta, tokenCorrupted] = tryReadOption(beet.coption(TokenStandard_1.tokenStandardBeet), buf, cursor);\n  cursor += tokenDelta;\n  const [collection, collectionDelta, collectionCorrupted] = tokenCorrupted ? [null, NONE_BYTE_SIZE, true] : tryReadOption(beet.coption(Collection_1.collectionBeet), buf, cursor);\n  cursor += collectionDelta;\n  const [uses, usesDelta, usesCorrupted] = tokenCorrupted || collectionCorrupted ? [null, NONE_BYTE_SIZE, true] : tryReadOption(beet.coption(Uses_1.usesBeet), buf, cursor);\n  cursor += usesDelta;\n  const [collectionDetails, collectionDetailsDelta, collectionDetailsCorrupted] = tokenCorrupted || collectionCorrupted || usesCorrupted ? [null, NONE_BYTE_SIZE, true] : tryReadOption(beet.coption(CollectionDetails_1.collectionDetailsBeet), buf, cursor);\n  cursor += collectionDetailsDelta;\n  const anyCorrupted = tokenCorrupted || collectionCorrupted || usesCorrupted || collectionDetailsCorrupted;\n  const args = {\n    key,\n    updateAuthority,\n    mint,\n    data,\n    primarySaleHappened,\n    isMutable,\n    editionNonce,\n    tokenStandard: anyCorrupted ? null : tokenStandard,\n    collection: anyCorrupted ? null : collection,\n    uses: anyCorrupted ? null : uses,\n    collectionDetails: anyCorrupted ? null : collectionDetails\n  };\n  return [Metadata_1.Metadata.fromArgs(args), cursor];\n}\n\nexports.deserialize = deserialize;\n\nfunction tryReadOption(optionBeet, buf, offset) {\n  try {\n    const fixed = optionBeet.toFixedFromData(buf, offset);\n    const value = fixed.read(buf, offset);\n    return [value, fixed.byteSize, false];\n  } catch (err) {\n    return [null, NONE_BYTE_SIZE, true];\n  }\n}","map":{"version":3,"sources":["../../../src/custom/metadata-deserializer.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.deserialize = void 0;\nconst beet = __importStar(require(\"@metaplex-foundation/beet\"));\nconst beetSolana = __importStar(require(\"@metaplex-foundation/beet-solana\"));\nconst Metadata_1 = require(\"../generated/accounts/Metadata\");\nconst Collection_1 = require(\"../generated/types/Collection\");\nconst CollectionDetails_1 = require(\"../generated/types/CollectionDetails\");\nconst Data_1 = require(\"../generated/types/Data\");\nconst Key_1 = require(\"../generated/types/Key\");\nconst TokenStandard_1 = require(\"../generated/types/TokenStandard\");\nconst Uses_1 = require(\"../generated/types/Uses\");\nconst NONE_BYTE_SIZE = beet.coptionNone('').byteSize;\nfunction deserialize(buf, offset = 0) {\n    let cursor = offset;\n    const key = Key_1.keyBeet.read(buf, cursor);\n    cursor += Key_1.keyBeet.byteSize;\n    const updateAuthority = beetSolana.publicKey.read(buf, cursor);\n    cursor += beetSolana.publicKey.byteSize;\n    const mint = beetSolana.publicKey.read(buf, cursor);\n    cursor += beetSolana.publicKey.byteSize;\n    const [data, dataDelta] = Data_1.dataBeet.deserialize(buf, cursor);\n    cursor = dataDelta;\n    const primarySaleHappened = beet.bool.read(buf, cursor);\n    cursor += beet.bool.byteSize;\n    const isMutable = beet.bool.read(buf, cursor);\n    cursor += beet.bool.byteSize;\n    const editionNonceBeet = beet.coption(beet.u8).toFixedFromData(buf, cursor);\n    const editionNonce = editionNonceBeet.read(buf, cursor);\n    cursor += editionNonceBeet.byteSize;\n    const [tokenStandard, tokenDelta, tokenCorrupted] = tryReadOption(beet.coption(TokenStandard_1.tokenStandardBeet), buf, cursor);\n    cursor += tokenDelta;\n    const [collection, collectionDelta, collectionCorrupted] = tokenCorrupted\n        ? [null, NONE_BYTE_SIZE, true]\n        : tryReadOption(beet.coption(Collection_1.collectionBeet), buf, cursor);\n    cursor += collectionDelta;\n    const [uses, usesDelta, usesCorrupted] = tokenCorrupted || collectionCorrupted\n        ? [null, NONE_BYTE_SIZE, true]\n        : tryReadOption(beet.coption(Uses_1.usesBeet), buf, cursor);\n    cursor += usesDelta;\n    const [collectionDetails, collectionDetailsDelta, collectionDetailsCorrupted] = tokenCorrupted || collectionCorrupted || usesCorrupted\n        ? [null, NONE_BYTE_SIZE, true]\n        : tryReadOption(beet.coption(CollectionDetails_1.collectionDetailsBeet), buf, cursor);\n    cursor += collectionDetailsDelta;\n    const anyCorrupted = tokenCorrupted || collectionCorrupted || usesCorrupted || collectionDetailsCorrupted;\n    const args = {\n        key,\n        updateAuthority,\n        mint,\n        data,\n        primarySaleHappened,\n        isMutable,\n        editionNonce,\n        tokenStandard: anyCorrupted ? null : tokenStandard,\n        collection: anyCorrupted ? null : collection,\n        uses: anyCorrupted ? null : uses,\n        collectionDetails: anyCorrupted ? null : collectionDetails,\n    };\n    return [Metadata_1.Metadata.fromArgs(args), cursor];\n}\nexports.deserialize = deserialize;\nfunction tryReadOption(optionBeet, buf, offset) {\n    try {\n        const fixed = optionBeet.toFixedFromData(buf, offset);\n        const value = fixed.read(buf, offset);\n        return [value, fixed.byteSize, false];\n    }\n    catch (err) {\n        return [null, NONE_BYTE_SIZE, true];\n    }\n}\n//# sourceMappingURL=metadata-deserializer.js.map"]},"metadata":{},"sourceType":"script"}